<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIVE BUS TRACKER | School Transport Hub</title>
    <link rel="icon" href="Dps logo.jpeg" type="image/jpeg">
    <link rel="stylesheet" href="style.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&family=JetBrains+Mono:wght@700&display=swap"
        rel="stylesheet">
</head>

<body>
    <header>
        <div class="school-section">
            <img src="school logo.png" alt="School Logo" class="logo">
            <div class="title-group">
                <h1>BUS TRACKER</h1>
                <p>Delhi Public School • Smart Gateway Hub</p>
            </div>
        </div>
        <div class="clock-section">
            <div id="time">00:00:00</div>
            <div id="date">JAN 14, 2026</div>
        </div>
    </header>

    <main>
        <!-- Main Board -->
        <section class="board-section terminal-section">
            <div class="section-header">
                <div class="header-main">
                    <span class="status-dot green"></span>
                    <h2>LIVE BUS STATUS</h2>
                </div>
            </div>
            <div class="slider-container" id="terminalContainer">
                <div class="slider-track" id="terminalTrack">
                    <!-- Pages will be injected here -->
                </div>
            </div>
        </section>
    </main>

    <div id="alertBanner" class="alert-banner">
        <div class="banner-content">
            <span class="banner-icon">⚠️</span>
            <p><strong>ATTENTION:</strong> Students utilizing buses currently in 'WAITING' status are requested to
                remain in the Open Auditorium until the buses are parked.</p>
        </div>
    </div>

    <footer>
        <div class="attribution">
            MADE BY <span>A.ADVAITH 7P</span>
        </div>
        <div class="system-tag">
            SECURE LIVE GPS FEED • AUTO-REFRESH ACTIVE
        </div>
    </footer>

    <script>
        const buses = [
            { id: "S01", status: "BUS BAY AREA" }, { id: "S02", status: "BUS BAY AREA" },
            { id: "S03", status: "OPEN AUDITORIUM" }, { id: "S04", status: "OPEN AUDITORIUM" },
            { id: "S05", status: "BUS BAY AREA" }, { id: "S06", status: "BUS BAY AREA" },
            { id: "S07", status: "WAITING" }, { id: "S08", status: "ON ROAD" },
            { id: "S09", status: "WAITING" }, { id: "S10", status: "ON ROAD" },
            { id: "S11", status: "BUS BAY AREA" }, { id: "S12", status: "OPEN AUDITORIUM" },
            { id: "S13", status: "BUS BAY AREA" }, { id: "S14", status: "BUS BAY AREA" },
            { id: "S15", status: "WAITING" }, { id: "S16", status: "WAITING" },
            { id: "S17", status: "ON ROAD" }, { id: "S18", status: "ON ROAD" },
            { id: "S19", status: "BUS BAY AREA" }, { id: "S20", status: "BUS BAY AREA" },
            { id: "S21", status: "OPEN AUDITORIUM" }, { id: "S22", status: "OPEN AUDITORIUM" },
            { id: "S23", status: "WAITING" }, { id: "S24", status: "WAITING" },
            { id: "S25", status: "ON ROAD" }, { id: "S26", status: "ON ROAD" },
            { id: "S27", status: "BUS BAY AREA" }, { id: "S28", status: "BUS BAY AREA" },
            { id: "S29", status: "OPEN AUDITORIUM" }, { id: "S30", status: "OPEN AUDITORIUM" },
            { id: "S31", status: "WAITING" }, { id: "S32", status: "WAITING" },
            { id: "S33", status: "ON ROAD" }, { id: "S34", status: "ON ROAD" },
            { id: "S35", status: "WAITING" }
        ];

        function updateClock() {
            const now = new Date();
            const timeEl = document.getElementById('time');
            const dateEl = document.getElementById('date');

            if (timeEl) {
                timeEl.textContent = now.toLocaleTimeString('en-US', {
                    hour12: true,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                }).toUpperCase();
            }
            if (dateEl) {
                dateEl.textContent = now.toLocaleDateString('en-US', {
                    month: 'short',
                    day: 'numeric',
                    year: 'numeric'
                }).toUpperCase();
            }
        }

        function getDynamicPerPage(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return 5;

            // Fix for mobile: Stacking rather than squashing
            if (window.innerWidth < 600) return 8;

            // Approximate heights based on CSS
            const containerHeight = container.offsetHeight;
            const headerHeight = 50; // Table header + padding
            const rowHeight = window.innerHeight < 600 ? 35 : 55; // Expected row height

            const availableHeight = containerHeight - headerHeight;
            const count = Math.floor(availableHeight / rowHeight);

            return Math.max(1, count); // At least 1 per page
        }

        function createSlider(type, items) {
            const track = document.getElementById(`${type}Track`);
            const containerId = `${type}Container`;
            const perPage = getDynamicPerPage(containerId);
            const totalPages = Math.ceil(items.length / perPage);

            track.innerHTML = '';
            track.style.transform = 'translateX(0)';

            track.innerHTML = '';

            // Fixed header table
            const headerTable = document.createElement('table');
            headerTable.className = 'display-board fixed-header';
            headerTable.innerHTML = `
    <thead>
        <tr class="board-header">
            <th style="width: 35%">BUS ID</th>
            <th style="width: 65%">LOCATION</th>
        </tr>
    </thead>
`;

            // Scrolling body wrapper (viewport)
            const viewport = document.createElement('div');
            viewport.className = 'marquee-viewport';

            // Scrolling ribbon (animated)
            const ribbon = document.createElement('div');
            ribbon.className = 'marquee-ribbon';

            // Duplicate rows for seamless loop
            const rows = [...items, ...items];

            const bodyTable = document.createElement('table');
            bodyTable.className = 'display-board';

            bodyTable.innerHTML = `
    <tbody>
        ${rows.map(bus => {
                const statusClass = bus.status.replace(/\s+/g, '-').toLowerCase();
                return `
                <tr class="bus-row row-${statusClass}">
                    <td style="width:35%">
                        <div class="bus-badge">${bus.id}</div>
                    </td>
                    <td style="width:65%">
                        <div class="status-wrapper ${statusClass}">
                            <span class="status-text">${bus.status}</span>
                        </div>
                    </td>
                </tr>
            `;
            }).join('')}
    </tbody>
`;

            ribbon.appendChild(bodyTable);
            viewport.appendChild(ribbon);

            track.appendChild(headerTable);
            track.appendChild(viewport);

        }

        function initDashboard() {
            updateClock();
            // Render all buses in one list, mixed together
            createSlider('terminal', buses);
        }

        document.addEventListener('DOMContentLoaded', () => {
            initDashboard();
            setInterval(updateClock, 1000);

            // Handle Resize
            let resizeTimer;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(() => {
                    initDashboard();
                }, 250);
            });

            console.log("Professional Dashboard Initialized for Public Display.");
        });
    </script>
</body>

</html>